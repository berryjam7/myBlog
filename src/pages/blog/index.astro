---
import { getCollection } from "astro:content";
import PageLayout from "../../layouts/PageLayout.astro";
import PostList from "../../components/PostList.astro";
import SearchBar from "../../components/SearchBar.astro";

const allPosts = await getCollection("blog", ({ data }) => !data.draft);
const sortedPosts = allPosts.sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<PageLayout
  title="Blog - All Posts"
  description="Browse all blog posts. Discover the latest tech, tutorials, and various topics."
>
  <div class="blog-page">
    <header class="page-header">
      <h1>Blog</h1>
      <p>Total {sortedPosts.length} posts</p>
    </header>

    <div style="margin: 2rem 0;">
      <SearchBar />
    </div>

    <PostList posts={sortedPosts} />
  </div>
</PageLayout>

<style>
  .page-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .page-header h1 {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
  }

  .page-header p {
    color: var(--text-secondary);
    font-size: 1.125rem;
  }
</style>
